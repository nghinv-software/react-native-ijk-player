{"version":3,"sources":["IJKPlayer.tsx"],"names":["React","Component","StyleSheet","requireNativeComponent","NativeModules","resolveAssetSource","IJKPlayerModule","IJKPlayerComponent","IJKPlayer","createRef","time","pauseAfterSeek","seek","volume","setNativeProps","paused","mute","path","response","takeSnapshot","pan","l","r","setPan","snapshotPath","preset","setEQPreset","event","props","onLoadStart","nativeEvent","init","onLoad","onError","onProgress","onPause","onStop","onEnd","onBuffer","onTimedText","index","selectedTextTrack","getSelectedTracks","selectedAudioTrack","deselectTrack","onPlay","nativeProps","ijkPlayerRef","current","render","source","headers","userAgent","uri","match","style","styles","base","src","onVideoLoadStart","_onLoadStart","onVideoLoad","_onLoad","onVideoError","_onError","onVideoProgress","_onProgress","onVideoPause","_onPause","onVideoStop","_onStop","onVideoEnd","_onEnd","onVideoBuffer","_onBuffer","_onTimedText","_onPlay","create","overflow"],"mappings":"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","sourcesContent":["/**\n * Created by nghinv on Thu Aug 05 2021\n * Copyright (c) 2021 nghinv@lumi.biz\n */\n\nimport React, { Component } from 'react';\nimport { StyleSheet, requireNativeComponent, ViewProps, NativeModules, NativeMethods } from 'react-native';\n// @ts-ignore\nimport resolveAssetSource from 'react-native/Libraries/Image/resolveAssetSource';\n\nconst IJKPlayerModule = NativeModules.IJKPlayerModule;\nconst IJKPlayerComponent = requireNativeComponent('RCTIJKPlayer');\n\nexport type Source = {\n  uri: string,\n  headers?: object,\n  userAgent?: string,\n}\n\nexport type Event = {\n  nativeEvent: any;\n}\n\nexport interface IJKPlayerProps extends ViewProps {\n  src: object;\n  seek?: number;\n  snapshotPath?: string;\n  onVideoLoadStart?: (event: Event) => void;\n  onVideoLoad?: (event: Event) => void;\n  onVideoBuffer?: (event: Event) => void;\n  onVideoError?: (event: Event) => void;\n  onVideoProgress?: (event: Event) => void;\n  onVideoPause?: (event: Event) => void;\n  onVideoStop?: (event: Event) => void;\n  onVideoEnd?: (event: Event) => void;\n  onTimedText?: (event: Event) => void;\n\n  source: Array<Source>;\n  muted?: boolean;\n  volume?: number;\n  onLoadStart?: (event: Event) => void;\n  onLoad?: (event: Event) => void;\n  onPlay?: () => void;\n  onBuffer?: (event: Event) => void;\n  onError?: (event: Event) => void;\n  onProgress?: (event: Event) => void;\n  onPause?: (event: Event) => void;\n  onStop?: (event: Event) => void;\n  onEnd?: (event: Event) => void;\n\n  scaleX?: number;\n  scaleY?: number;\n  translateX?: number;\n  translateY?: number;\n  rotation?: number;\n}\n\nexport default class IJKPlayer extends Component<IJKPlayerProps> {\n  ijkPlayerRef = React.createRef<NativeMethods>();\n\n  setNativeProps(nativeProps: any) {\n    this.ijkPlayerRef.current?.setNativeProps(nativeProps);\n  }\n\n  seek = (time: number, pauseAfterSeek?: boolean) => {\n    IJKPlayerModule.seek(time, pauseAfterSeek ?? false);\n  };\n\n  setVolume = (volume: number) => {\n    this.setNativeProps({ volume });\n  }\n\n  setPaused = (paused: boolean) => {\n    this.setNativeProps({ paused });\n  }\n\n  setMute = (mute: boolean) => {\n    this.setNativeProps({ mute });\n  }\n\n  takeSnapshot = async (path: string) => {\n    const response = await IJKPlayerModule.takeSnapshot(path);\n\n    return response;\n  }\n\n  setPan = (pan: number) => {\n    const l = pan < 0 ? 1 : 1 - pan;\n    const r = pan < 0 ? 1 + pan : 1;\n\n    IJKPlayerModule.setPan(l, r);\n  }\n\n  snapshot = (snapshotPath: string) => {\n    this.setNativeProps({ snapshotPath });\n  };\n\n  setEQPreset = (preset: any) => {\n    IJKPlayerModule.setEQPreset(preset);\n  }\n\n  _onLoadStart = (event: Event) => {\n    this.props.onLoadStart?.(event.nativeEvent);\n  };\n\n  _onLoad = (event: Event) => {\n    IJKPlayerModule.init();\n    this.props.onLoad?.(event.nativeEvent);\n  };\n\n  _onError = (event: Event) => {\n    this.props.onError?.(event.nativeEvent);\n  };\n\n  _onProgress = (event: Event) => {\n    this.props.onProgress?.(event.nativeEvent);\n  };\n\n  _onPause = (event: Event) => {\n    this.props.onPause?.(event.nativeEvent);\n  };\n\n  _onStop = (event: Event) => {\n    this.props.onStop?.(event.nativeEvent);\n  };\n\n  _onEnd = (event: Event) => {\n    this.props.onEnd?.(event.nativeEvent);\n  };\n\n  _onBuffer = (event: Event) => {\n    this.props.onBuffer?.(event.nativeEvent);\n  };\n\n  _onTimedText = (event: Event) => {\n    this.props.onTimedText?.(event.nativeEvent);\n  }\n\n  setTextTrackIndex = (index: number) => {\n    this.setNativeProps({ selectedTextTrack: index });\n  }\n\n  setAudioTrackIndex = (index: number) => {\n    IJKPlayerModule.getSelectedTracks();\n    this.setNativeProps({ selectedAudioTrack: index });\n  }\n\n  deselectTrack = (index: number) => {\n    this.setNativeProps({ deselectTrack: index });\n  }\n\n  _onPlay = () => {\n    this.props.onPlay?.();\n  }\n\n  render() {\n    const source = resolveAssetSource(this.props.source) || {};\n    const headers = source.headers ?? {};\n    const userAgent = source.userAgent ?? '';\n\n    let uri = source.uri ?? '';\n    if (uri && uri.match(/^\\//)) {\n      uri = `file://${uri}`;\n    }\n\n    const nativeProps = {\n      ...this.props,\n      style: [styles.base, this.props.style],\n      src: {\n        uri,\n        headers,\n        userAgent,\n      },\n      onVideoLoadStart: this._onLoadStart,\n      onVideoLoad: this._onLoad,\n      onVideoError: this._onError,\n      onVideoProgress: this._onProgress,\n      onVideoPause: this._onPause,\n      onVideoStop: this._onStop,\n      onVideoEnd: this._onEnd,\n      onVideoBuffer: this._onBuffer,\n      onTimedText: this._onTimedText,\n      onPlay: this._onPlay,\n    };\n\n    return (\n      <IJKPlayerComponent\n        // @ts-ignore\n        ref={this.ijkPlayerRef}\n        nativeOnly={{\n          src: true,\n          seek: true,\n          snapshotPath: true,\n        }}\n        {...nativeProps}\n      />\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  base: {\n    overflow: 'hidden',\n  },\n});\n"]}